angular.module("angular-jsvat",["angular-jsvat.templates","angular-jsvat-input"]).factory("JsVatFactory",function(){var r=function(){"use strict";function r(r,e){return e.test(r)}function e(r,e,t){var s=e.exec(r),i=s[2];return a[t].calcs(i)}function t(t,s,i){var l=!1;return r(t,s)&&(l=e(t,s,i)),l}function s(r){return r.toString().toUpperCase().replace(/(\s|-|\.)+/g,"")}function i(r){return Array.isArray(r)?r:[r]}function l(r,e){if(!r||0===Object.keys(r).length)return!1;var t=r[e];return null===t||null===t?!0:!t}var a={},u={config:{},checkVAT:function(r,e){if(!r)return!1;r=s(r);var n={isValid:!1,countries:[]};for(var c in a)if(a.hasOwnProperty(c)&&!l(u.config,c))for(var o=i(a[c].rules.regex),f=0;f<o.length;f++){if(n.isValid=t(r,o[f],c)?!0:n.isValid,!e&&n.isValid)return n.isValid;var d=t(r,o[f],c);d&&n.countries.push(c)}return e?n:n.isValid}};return a.austria={calcs:function(r){for(var e,t=0,s=0;7>s;s++)e=r.charAt(s)*this.rules.multipliers[s],t+=e>9?Math.floor(e/10)+e%10:e;return t=10-(t+4)%10,10===t&&(t=0),t===+r.slice(7,8)},rules:{multipliers:[1,2,1,2,1,2,1],regex:/^(AT)U(\d{8})$/}},a.belgium={calcs:function(r){if(9===r.length&&(r="0"+r),0===+r.slice(1,2))return!1;var e=97-+r.slice(0,8)%97;return e===+r.slice(8,10)},rules:{regex:/^(BE)(0?\d{9})$/}},a.bulgaria=function(){function r(r){for(var e,t=0,s=+r.slice(8),i=0;8>i;i++)t+=+r.charAt(i)*(i+1);if(e=t%11,10!==e)return e===s;t=0;for(var l=0;8>l;l++)t+=+r.charAt(l)*(l+3);return e=t%11,10===e&&(e=0),e===s}function e(r,e){var t=0;if(/^\d\d[0-5]\d[0-3]\d\d{4}$/.test(r)){var s=+r.slice(2,4);if(s>0&&13>s||s>20&&33>s||s>40&&53>s){t=0;for(var i=0;9>i;i++)t+=+r.charAt(i)*e.multipliers.physical[i];if(t%=11,10===t&&(t=0),t===+r.substr(9,1))return!0}}return!1}function t(r,e){for(var t=0,s=0;9>s;s++)t+=+r.charAt(s)*e.multipliers.foreigner[s];return t%10===+r.substr(9,1)?!0:void 0}function s(r,e){for(var t=0,s=0;9>s;s++)t+=+r.charAt(s)*e.multipliers.miscellaneous[s];if(t=11-t%11,10===t)return!1;11===t&&(t=0);var i=+r.substr(9,1);return t===i}return{calcs:function(i){return 9===i.length?r(i):e(i,this.rules)||t(i,this.rules)||s(i,this.rules)},rules:{multipliers:{physical:[2,4,8,5,10,9,7,3,6],foreigner:[21,19,17,13,11,9,7,3,1],miscellaneous:[4,3,2,7,6,5,4,3,2]},regex:/^(BG)(\d{9,10})$/}}}(),a.croatia={calcs:function(r){for(var e,t=10,s=0,i=0;10>i;i++)s=(+r.charAt(i)+t)%10,0===s&&(s=10),t=2*s%11;return e=+r.slice(10,11),(t+e)%10===1},rules:{regex:/^(HR)(\d{11})$/}},a.cyprus={calcs:function(r){var e,t=0;if(12===+r.slice(0,2))return!1;for(var s=0;8>s;s++){var i=+r.charAt(s);if(s%2===0)switch(i){case 0:i=1;break;case 1:i=0;break;case 2:i=5;break;case 3:i=7;break;case 4:i=9;break;default:i=2*i+3}t+=i}return t%=26,t=String.fromCharCode(t+65),e=r.substr(8,1),t===e},rules:{regex:/^(CY)([0-59]\d{7}[A-Z])$/}},a.czech_republic=function(){function r(r,e){var t=0;if(e.additional[0].test(r)){for(var s=0;7>s;s++)t+=+r.charAt(s)*e.multipliers[s];t=11-t%11,10===t&&(t=0),11===t&&(t=1);var i=+r.slice(7,8);return t===i}return!1}function e(r,e){var t=0;if(e.additional[2].test(r)){for(var s=0;7>s;s++)t+=+r.charAt(s+1)*e.multipliers[s];t=11-t%11,10===t&&(t=0),11===t&&(t=1);var i=+r.slice(8,9);return e.lookup[t-1]===i}return!1}function t(r,e){if(e.additional[3].test(r)){var t=+r.slice(0,2)+r.slice(2,4)+r.slice(4,6)+r.slice(6,8)+r.slice(8),s=+r%11===0;return!(t%11!==0||!s)}return!1}return{calcs:function(s){return r(s,this.rules)?!0:e(s,this.rules)?!0:t(s,this.rules)?!0:!1},rules:{multipliers:[8,7,6,5,4,3,2],lookup:[8,7,6,5,4,3,2,1,0,9,10],regex:/^(CZ)(\d{8,10})(\d{3})?$/,additional:[/^\d{8}$/,/^[0-5][0-9][0|1|5|6]\d[0-3]\d\d{3}$/,/^6\d{8}$/,/^\d{2}[0-3|5-8]\d[0-3]\d\d{4}$/]}}}(),a.denmark={calcs:function(r){for(var e=0,t=0;8>t;t++)e+=+r.charAt(t)*this.rules.multipliers[t];return e%11===0},rules:{multipliers:[2,7,6,5,4,3,2,1],regex:/^(DK)(\d{8})$/}},a.estonia={calcs:function(r){for(var e,t=0,s=0;8>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=10-t%10,10===t&&(t=0),e=+r.slice(8,9),t===e},rules:{multipliers:[3,7,1,3,7,1,3,7],regex:/^(EE)(10\d{7})$/}},a.europe={calcs:function(){return!0},rules:{regex:/^(EU)(\d{9})$/}},a.finland={calcs:function(r){for(var e,t=0,s=0;7>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=11-t%11,t>9&&(t=0),e=+r.slice(7,8),t===e},rules:{multipliers:[7,9,10,5,8,4,2],regex:/^(FI)(\d{8})$/}},a.france={calcs:function(r){var e,t;return/^\d{11}$/.test(r)?(e=+r.substring(2),e=(100*e+12)%97,t=+r.slice(0,2),e===t):!0},rules:{regex:[/^(FR)(\d{11})$/,/^(FR)([A-HJ-NP-Z]\d{10})$/,/^(FR)(\d[A-HJ-NP-Z]\d{9})$/,/^(FR)([A-HJ-NP-Z]{2}\d{9})$/]}},a.germany={calcs:function(r){for(var e,t=10,s=0,i=0,l=0;8>l;l++)s=(+r.charAt(l)+t)%10,0===s&&(s=10),t=2*s%11;return i=11-t===10?0:11-t,e=+r.slice(8,9),i===e},rules:{regex:/^(DE)([1-9]\d{8})$/}},a.greece={calcs:function(r){var e,t=0;8===r.length&&(r="0"+r);for(var s=0;8>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t%=11,t>9&&(t=0),e=+r.slice(8,9),t===e},rules:{multipliers:[256,128,64,32,16,8,4,2],regex:/^(EL)(\d{9})$/}},a.hungary={calcs:function(r){for(var e,t=0,s=0;7>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=10-t%10,10===t&&(t=0),e=+r.slice(7,8),t===e},rules:{multipliers:[9,7,3,1,9,7,3],regex:/^(HU)(\d{8})$/}},a.ireland={calcs:function(r){var e,t=0;this.rules.typeFormats.first.test(r)&&(r="0"+r.substring(2,7)+r.substring(0,1)+r.substring(7,8));for(var s=0;7>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return this.rules.typeFormats.third.test(r)&&(t+="H"===r.charAt(8)?72:9),t%=23,t=0===t?"W":String.fromCharCode(t+64),e=r.slice(7,8),t===e},rules:{multipliers:[8,7,6,5,4,3,2],typeFormats:{first:/^\d[A-Z\*\+]/,third:/^\d{7}[A-Z][AH]$/},regex:[/^(IE)(\d{7}[A-W])$/,/^(IE)([7-9][A-Z\*\+)]\d{5}[A-W])$/,/^(IE)(\d{7}[A-W][AH])$/]}},a.italy={calcs:function(r){var e,t,s=0;if(0===+r.slice(0,7))return!1;if(e=+r.slice(7,10),1>e||e>201&&999!==e&&888!==e)return!1;for(var i=0;10>i;i++)e=+r.charAt(i)*this.rules.multipliers[i],s+=e>9?Math.floor(e/10)+e%10:e;return s=10-s%10,s>9&&(s=0),t=+r.slice(10,11),s===t},rules:{multipliers:[1,2,1,2,1,2,1,2,1,2],regex:/^(IT)(\d{11})$/}},a.latvia={calcs:function(r){var e,t=0;if(/^[0-3]/.test(r))return!!/^[0-3][0-9][0-1][0-9]/.test(r);for(var s=0;10>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t%11===4&&9===r[0]&&(t-=45),t%11===4?t=4-t%11:t%11>4?t=14-t%11:4>t%11&&(t=3-t%11),e=+r.slice(10,11),t===e},rules:{multipliers:[9,1,4,8,3,10,2,5,7,6],regex:/^(LV)(\d{11})$/}},a.lithunia=function(){function r(r,e,t){return+r.charAt(t)*e[t]}function e(e,t,s){if(t%11===10){t=0;for(var i=0;8>i;i++)t+=r(e,s.multipliers["short"],i)}return t}function t(r,e){for(var t=0;8>t;t++)e+=+r.charAt(t)*(t+1);return e}function s(r){return r%=11,10===r&&(r=0),r}function i(r,i){var l=0;if(9===r.length){if(!/^\d{7}1/.test(r))return!1;l=t(r,l),l=e(r,l,i),l=s(l);var a=+r.slice(8,9);return l===a}return!1}function l(e,t,s){for(var i=0;11>i;i++)t+=r(e,s.multipliers.med,i);return t}function a(e,t,s){if(t%11===10){t=0;for(var i=0;11>i;i++)t+=r(e,s.multipliers.alt,i)}return t}function u(r,e){var t=0;if(12===r.length){if(!e.check.test(r))return!1;t=l(r,t,e),t=a(r,t,e),t=s(t);var i=+r.slice(11,12);return t===i}return!1}return{calcs:function(r){return i(r,this.rules)||u(r,this.rules)},rules:{multipliers:{"short":[3,4,5,6,7,8,9,1],med:[1,2,3,4,5,6,7,8,9,1,2],alt:[3,4,5,6,7,8,9,1,2,3,4]},check:/^\d{10}1/,regex:/^(LT)(\d{9}|\d{12})$/}}}(),a.luxembourg={calcs:function(r){var e=+r.slice(6,8),t=+r.slice(0,6)%89;return t===e},rules:{regex:/^(LU)(\d{8})$/}},a.malta={calcs:function(r){for(var e,t=0,s=0;6>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=37-t%37,e=+r.slice(6,8),t===e},rules:{multipliers:[3,4,6,7,8,9],regex:/^(MT)([1-9]\d{7})$/}},a.netherlands={calcs:function(r){for(var e,t=0,s=0;8>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t%=11,t>9&&(t=0),e=+r.slice(8,9),t===e},rules:{multipliers:[9,8,7,6,5,4,3,2],regex:/^(NL)(\d{9})B\d{2}$/}},a.norway={calcs:function(r){for(var e,t=0,s=0;8>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=11-t%11,11===t&&(t=0),10>t?(e=+r.slice(8,9),t===e):void 0},rules:{multipliers:[3,2,7,6,5,4,3,2],regex:/^(NO)(\d{9})$/}},a.poland={calcs:function(r){for(var e,t=0,s=0;9>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t%=11,t>9&&(t=0),e=+r.slice(9,10),t===e},rules:{multipliers:[6,5,7,2,3,4,5,6,7],regex:/^(PL)(\d{10})$/}},a.portugal={calcs:function(r){for(var e,t=0,s=0;8>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=11-t%11,t>9&&(t=0),e=+r.slice(8,9),t===e},rules:{multipliers:[9,8,7,6,5,4,3,2],regex:/^(PT)(\d{9})$/}},a.romania={calcs:function(r){for(var e,t=0,s=r.length,i=this.rules.multipliers.slice(10-s),l=0;l<r.length-1;l++)t+=+r.charAt(l)*i[l];return t=10*t%11,10===t&&(t=0),e=+r.slice(r.length-1,r.length),t===e},rules:{multipliers:[7,5,3,2,1,7,5,3,2],regex:/^(RO)([1-9]\d{1,9})$/}},a.russia=function(){function r(r,e){var t=0;if(10===r.length){for(var s=0;10>s;s++)t+=+r.charAt(s)*e.multipliers.m_1[s];t%=11,t>9&&(t%=10);var i=+r.slice(9,10);return t===i}return!1}function e(r,e){var t=0,s=0;if(12===r.length){for(var i=0;11>i;i++)t+=+r.charAt(i)*e.multipliers.m_2[i];t%=11,t>9&&(t%=10);for(var l=0;11>l;l++)s+=+r.charAt(l)*e.multipliers.m_3[l];s%=11,s>9&&(s%=10);var a=t===+r.slice(10,11),u=s===+r.slice(11,12);return a&&u}return!1}return{calcs:function(t){return r(t,this.rules)||e(t,this.rules)},rules:{multipliers:{m_1:[2,4,10,3,5,9,4,6,8,0],m_2:[7,2,4,10,3,5,9,4,6,8,0],m_3:[3,7,2,4,10,3,5,9,4,6,8,0]},regex:/^(RU)(\d{10}|\d{12})$/}}}(),a.serbia={calcs:function(r){for(var e,t=10,s=0,i=0;8>i;i++)s=(+r.charAt(i)+t)%10,0===s&&(s=10),t=2*s%11;var l=1;return e=(t+ +r.slice(8,9))%10,e===l},rules:{regex:/^(RS)(\d{9})$/}},a.slovakia_republic={calcs:function(r){var e=0,t=r%11;return t===e},rules:{regex:/^(SK)([1-9]\d[2346-9]\d{7})$/}},a.slovenia={calcs:function(r){for(var e,t=0,s=0;7>s;s++)t+=+r.charAt(s)*this.rules.multipliers[s];return t=11-t%11,10===t&&(t=0),e=+r.slice(7,8),!(11===t||t!==e)},rules:{multipliers:[8,7,6,5,4,3,2],regex:/^(SI)([1-9]\d{7})$/}},a.spain={calcs:function(r){var e,t,s=0,i=0;if(this.rules.additional[0].test(r)){for(s=0;7>s;s++)e=r.charAt(s+1)*this.rules.multipliers[s],i+=e>9?Math.floor(e/10)+e%10:e;return i=10-i%10,10===i&&(i=0),t=+r.slice(8,9),i===t}if(this.rules.additional[1].test(r)){for(s=0;7>s;s++)e=r.charAt(s+1)*this.rules.multipliers[s],i+=e>9?Math.floor(e/10)+e%10:e;return i=10-i%10,i=String.fromCharCode(i+64),t=r.slice(8,9),i===t}if(this.rules.additional[2].test(r)){var l=r;return"Y"===l.substring(0,1)&&(l=l.replace(/Y/,"1")),"Z"===l.substring(0,1)&&(l=l.replace(/Z/,"2")),t="TRWAGMYFPDXBNJZSQVHLCKE".charAt(+l.substring(0,8)%23),l.charAt(8)===t}return this.rules.additional[3].test(r)?(t="TRWAGMYFPDXBNJZSQVHLCKE".charAt(+r.substring(1,8)%23),r.charAt(8)===t):!1},rules:{multipliers:[2,1,2,1,2,1,2],regex:[/^(ES)([A-Z]\d{8})$/,/^(ES)([A-HN-SW]\d{7}[A-J])$/,/^(ES)([0-9YZ]\d{7}[A-Z])$/,/^(ES)([KLMX]\d{7}[A-Z])$/],additional:[/^[A-H|J|U|V]\d{8}$/,/^[A-H|N-S|W]\d{7}[A-J]$/,/^[0-9|Y|Z]\d{7}[A-Z]$/,/^[K|L|M|X]\d{7}[A-Z]$/]}},a.sweden={calcs:function(r){for(var e,t,s=0,i=0;9>i;i+=2)t=+r.charAt(i),s+=Math.floor(t/5)+2*t%10;for(var l=0,a=1;9>a;a+=2)l+=+r.charAt(a);var u=(10-(s+l)%10)%10;return e=+r.slice(9,10),u===e},rules:{regex:/^(SE)(\d{10}01)$/}},a.switzerland={calcs:function(r){for(var e=0,t=0;8>t;t++)e+=+r.charAt(t)*this.rules.multipliers[t];if(e=11-e%11,10===e)return!1;11===e&&(e=0);var s=+r.substr(8,1);return e===s},rules:{multipliers:[5,4,3,2,7,6,5,4],regex:/^(CHE)(\d{9})(MWST)?$/}},a.united_kingdom={calcs:function(r){var e,t=0;if("GD"===r.substr(0,2))return e=500,r.substr(2,3)<e;if("HA"===r.substr(0,2))return e=499,r.substr(2,3)>e;if(0===+r.slice(0))return!1;for(var s=+r.slice(0,7),i=0;7>i;i++)t+=+r.charAt(i)*this.rules.multipliers[i];for(var l=t;l>0;)l-=97;return l=Math.abs(l),l===+r.slice(7,9)&&9990001>s&&(1e5>s||s>999999)&&(9490001>s||s>97e5)?!0:(l>=55?l-=55:l+=42,e=+r.slice(7,9),!!(l===e&&s>1e6))},rules:{multipliers:[8,7,6,5,4,3,2],regex:[/^(GB)?(\d{9})$/,/^(GB)?(\d{12})$/,/^(GB)?(GD\d{3})$/,/^(GB)?(HA\d{3})$/]}},"object"==typeof module&&module.exports&&(module.exports=u),u}();return r}),angular.module("angular-jsvat-input",[]).directive("jsvatInput",["$compile","JsVatFactory",function(r,e){return{restrict:"E",templateUrl:"jsvat_input.html",scope:{jsvatModel:"="},link:function(r,t,s,i){if(!angular.isObject(r.jsvatModel)){var l=r.jsvatModel;r.jsvatModel={value:l}}var a="-invalid",u="-valid";r.jsvatInputClassObj={},r.jsvatLabelClassObj={},r.jsvatInputClassObj[a]=!r.jsvatModel.isValid,r.jsvatLabelClassObj[a]=!r.jsvatModel.isValid,r.jsvatInputClassObj[u]=r.jsvatModel.isValid,r.jsvatLabelClassObj[u]=r.jsvatModel.isValid;var n=t.find("input").controller("ngModel");r.checkVAT=function(){var t=e.checkVAT(r.jsvatModel.value,!0);r.jsvatModel.isValid=t.isValid,r.jsvatModel.countries=t.countries,r.jsvatInputClassObj[a]=!t.isValid,r.jsvatLabelClassObj[a]=!t.isValid,r.jsvatInputClassObj[u]=t.isValid,r.jsvatLabelClassObj[u]=t.isValid,n.$setValidity("vat",t.isValid)},r.jsvatModel&&r.checkVAT()}}}]),angular.module("angular-jsvat.templates",[]).run(["$templateCache",function(r){r.put("jsvat_input.html",'<label ng-class="jsvatLabelClassObj" class="jsvat-input__block"><input type="text" name="vat" ng-model="jsvatModel.value" ng-change="checkVAT()" ng-class="jsvatInputClassObj" class="jsvat-input__field"/></label>')}]);
//# sourceMappingURL=angular-jsvat.min.js.map
